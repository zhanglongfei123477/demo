<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>


<body>
    <script>
        /* textPromises数组内四个promise不断变化 */
        function logInOrder(urls) {
            // 并发读取远程URL
            const textPromises = urls.map((url) => {
                console.log('00');
                const response = fetch(url).then((data) => {
                    console.log('...');
                    return data.text()
                });
                console.log('11');
                return response;
            })

            console.log(textPromises);
            Promise.all(textPromises).then(console.log)
        }
        logInOrder(['http://127.0.0.1/user01', 'http://127.0.0.1/user02', 'http://127.0.0.1/user03', 'http://127.0.0.1/user04'])
    </script>
</body>

</html>


<!-- // 1. 导入 express
const express = require('express')
// 2. 创建 web 服务器
const app = express()

// 4. 监听客户端的 GET 和 POST 请求，并向客户端响应具体的内容
app.get('/user01', (req, res) => {
    // 调用 express 提供的 res.send() 方法，向客户端响应一个 JSON 对象
    setTimeout(() => {
        res.setHeader('Access-Control-Allow-Origin', '*');
        res.send({ name: 'user01' })
    }, 6000)

})
app.get('/user02', (req, res) => {
    // 调用 express 提供的 res.send() 方法，向客户端响应一个 JSON 对象
    setTimeout(() => {
        res.setHeader('Access-Control-Allow-Origin', '*');
        res.send({ name: 'user02' })
    }, 1000)
})
app.get('/user03', (req, res) => {
    // 调用 express 提供的 res.send() 方法，向客户端响应一个 JSON 对象
    setTimeout(() => {
        res.setHeader('Access-Control-Allow-Origin', '*');
        res.send({ name: 'user03' })
    }, 6000)
})
app.get('/user04', (req, res) => {
    // 调用 express 提供的 res.send() 方法，向客户端响应一个 JSON 对象
    setTimeout(() => {
        res.setHeader('Access-Control-Allow-Origin', '*');
        res.send({ name: 'user04' })
    }, 6000)
})


// 注意：这里的 :id 是一个动态的参数
app.get('/user/:ids/:username', (req, res) => {
    res.setHeader('Access-Control-Allow-Origin', '*');
    // req.params 是动态匹配到的 URL 参数，默认也是一个空对象
    console.log(req.params)
    res.send(req.params)
})

// 3. 启动 web 服务器
app.listen(80, () => {
    console.log('express server running at http://127.0.0.1')
}) -->